using DartsScoreboardGames.Services.Models;

namespace DartsScoreboardGames.Services {

    public record struct Checkout(int Score, HashSet<Dart> Darts);

    public class CheckoutCalculator {

        public bool CanCheckout(int score, int throws = 3) => Checkouts.Contains(score) && Checkouts[score].Any(x => x.Darts.Count <= throws);
        public IEnumerable<Checkout> CheckoutsFor(int score, int throws = 3) => Checkouts[score].Where(x => x.Darts.Count <= throws);

        private readonly ILookup<int, Checkout> Checkouts = new Checkout[] {
            new (170, [ Dart.T20, Dart.T20, Dart.Bull ]),
            new (167, [ Dart.T20, Dart.T19, Dart.Bull ]),
            new (164, [ Dart.T20, Dart.T18, Dart.Bull ]),
            new (161, [ Dart.T20, Dart.T17, Dart.Bull ]),
            new (160, [ Dart.T20, Dart.T20, Dart.D20 ]),
            new (158, [ Dart.T20, Dart.T20, Dart.D19 ]),
            new (157, [ Dart.T20, Dart.T19, Dart.D20 ]),
            new (156, [ Dart.T20, Dart.T20, Dart.D18 ]),
            new (155, [ Dart.T20, Dart.T19, Dart.D19 ]),
            new (154, [ Dart.T20, Dart.T18, Dart.D20 ]),
            new (153, [ Dart.T20, Dart.T19, Dart.D18 ]),
            new (152, [ Dart.T20, Dart.T20, Dart.D16 ]),
            new (151, [ Dart.T20, Dart.T17, Dart.D20 ]),
            new (151, [ Dart.T19, Dart.T18, Dart.D20 ]),
            new (150, [ Dart.T20, Dart.T18, Dart.D18 ]),
            new (150, [ Dart.T19, Dart.T19, Dart.D18 ]),
            new (149, [ Dart.T20, Dart.T19, Dart.D16 ]),
            new (148, [ Dart.T20, Dart.T20, Dart.D14 ]),
            new (148, [ Dart.T20, Dart.T16, Dart.D20 ]),
            new (147, [ Dart.T20, Dart.T17, Dart.D18 ]),
            new (147, [ Dart.T19, Dart.T18, Dart.D18 ]),
            new (146, [ Dart.T20, Dart.T18, Dart.D16 ]),
            new (146, [ Dart.T19, Dart.T19, Dart.D16 ]),
            new (145, [ Dart.T20, Dart.T15, Dart.D20 ]),
            new (144, [ Dart.T20, Dart.T20, Dart.D12 ]),
            new (143, [ Dart.T20, Dart.T17, Dart.D16 ]),
            new (142, [ Dart.T20, Dart.T14, Dart.D20 ]),
            new (141, [ Dart.T20, Dart.T19, Dart.D12 ]),
            new (140, [ Dart.T20, Dart.T20, Dart.D10 ]),
            new (140, [ Dart.T20, Dart.D20, Dart.D20 ]),
            new (139, [ Dart.T20, Dart.T19, Dart.D11 ]),
            new (139, [ Dart.T19, Dart.T14, Dart.D20 ]),
            new (138, [ Dart.T20, Dart.T18, Dart.D12 ]),
            new (137, [ Dart.T20, Dart.T19, Dart.D10 ]),
            new (137, [ Dart.T19, Dart.D20, Dart.D20 ]),
            new (136, [ Dart.T20, Dart.T20, Dart.D8 ]),
            new (135, [ Dart.OuterBull, Dart.T20, Dart.Bull ]),
            new (135, [ Dart.Bull, Dart.T15, Dart.D20 ]),
            new (134, [ Dart.T20, Dart.T14, Dart.D16 ]),
            new (134, [ Dart.T18, Dart.D20, Dart.D20 ]),
            new (133, [ Dart.T20, Dart.T19, Dart.D8 ]),
            new (133, [ Dart.T19, Dart.D18, Dart.D20 ]),
            new (132, [ Dart.OuterBull, Dart.T19, Dart.Bull ]),
            new (132, [ Dart.Bull, Dart.Bull, Dart.D16 ]),
            new (131, [ Dart.T20, Dart.T13, Dart.D16 ]),
            new (131, [ Dart.T17, Dart.D20, Dart.D20 ]),
            new (130, [ Dart.T20, Dart.T20, Dart.D5 ]),
            new (130, [ Dart.S20, Dart.T20, Dart.Bull ]),
            new (129, [ Dart.T19, Dart.T16, Dart.D12 ]),
            new (129, [ Dart.S19, Dart.T20, Dart.Bull ]),
            new (128, [ Dart.T18, Dart.T14, Dart.D16 ]),
            new (128, [ Dart.S18, Dart.T20, Dart.Bull ]),
            new (127, [ Dart.T20, Dart.T17, Dart.D8 ]),
            new (127, [ Dart.S20, Dart.T19, Dart.Bull ]),
            new (126, [ Dart.T19, Dart.T19, Dart.D6 ]),
            new (126, [ Dart.S19, Dart.T19, Dart.Bull ]),
            new (125, [ Dart.OuterBull, Dart.T20, Dart.D20 ]),
            new (125, [ Dart.Bull, Dart.T17, Dart.D12 ]),
            new (124, [ Dart.T20, Dart.S14, Dart.Bull ]),
            new (124, [ Dart.S20, Dart.T18, Dart.Bull ]),
            new (123, [ Dart.T19, Dart.S16, Dart.Bull ]),
            new (123, [ Dart.S19, Dart.T18, Dart.Bull ]),
            new (122, [ Dart.T18, Dart.T18, Dart.D7 ]),
            new (122, [ Dart.S18, Dart.T18, Dart.Bull ]),
            new (121, [ Dart.T20, Dart.S11, Dart.Bull ]),
            new (121, [ Dart.S20, Dart.T17, Dart.Bull ]),
            new (120, [ Dart.T20, Dart.S20, Dart.D20 ]),
            new (120, [ Dart.S20, Dart.T20, Dart.D20 ]),
            new (119, [ Dart.T19, Dart.S12, Dart.Bull ]),
            new (119, [ Dart.S19, Dart.T20, Dart.D20 ]),
            new (118, [ Dart.T20, Dart.S18, Dart.D20 ]),
            new (118, [ Dart.S20, Dart.T20, Dart.D19 ]),
            new (117, [ Dart.T20, Dart.S17, Dart.D20 ]),
            new (117, [ Dart.S20, Dart.T19, Dart.D20 ]),
            new (116, [ Dart.T19, Dart.S19, Dart.D20 ]),
            new (116, [ Dart.S19, Dart.T19, Dart.D20 ]),
            new (115, [ Dart.T19, Dart.S18, Dart.D20 ]),
            new (115, [ Dart.S19, Dart.T20, Dart.D18 ]),
            new (114, [ Dart.T20, Dart.S14, Dart.D20 ]),
            new (114, [ Dart.S20, Dart.T18, Dart.D20 ]),
            new (113, [ Dart.T19, Dart.S16, Dart.D20 ]),
            new (113, [ Dart.S19, Dart.T18, Dart.D20 ]),
            new (112, [ Dart.T20, Dart.S12, Dart.D20 ]),
            new (112, [ Dart.S20, Dart.T20, Dart.D16 ]),
            new (111, [ Dart.T20, Dart.S11, Dart.D20 ]),
            new (111, [ Dart.S20, Dart.T17, Dart.D20 ]),
            new (110, [ Dart.T20, Dart.S10, Dart.D20 ]),
            new (110, [ Dart.S20, Dart.T18, Dart.D18 ]),
            new (109, [ Dart.T19, Dart.S12, Dart.D20 ]),
            new (109, [ Dart.S19, Dart.T19, Dart.D18 ]),
            new (108, [ Dart.T19, Dart.S19, Dart.D16 ]),
            new (108, [ Dart.S19, Dart.T19, Dart.D16 ]),
            new (107, [ Dart.T20, Dart.S15, Dart.D16 ]),
            new (107, [ Dart.S20, Dart.T17, Dart.D18 ]),
            new (106, [ Dart.T20, Dart.S6, Dart.D20 ]),
            new (106, [ Dart.S20, Dart.T18, Dart.D16 ]),
            new (105, [ Dart.T20, Dart.S5, Dart.D20 ]),
            new (105, [ Dart.S20, Dart.T15, Dart.D20 ]),
            new (104, [ Dart.T18, Dart.S10, Dart.D20 ]),
            new (104, [ Dart.S18, Dart.T18, Dart.D16 ]),
            new (103, [ Dart.T20, Dart.S11, Dart.D16 ]),
            new (103, [ Dart.S20, Dart.T17, Dart.D16 ]),
            new (102, [ Dart.T20, Dart.S10, Dart.D16 ]),
            new (101, [ Dart.T20, Dart.S9, Dart.D16 ]),
            new (101, [ Dart.S20, Dart.T19, Dart.D12 ]),
            new (100, [ Dart.T20, Dart.D20 ]),
            new (100, [ Dart.S20, Dart.T20, Dart.D10 ]),
            new (99, [ Dart.T19, Dart.S10, Dart.D16 ]),
            new (99, [ Dart.S19, Dart.T20, Dart.D10 ]),
            new (98, [ Dart.T20, Dart.D19 ]),
            new (98, [ Dart.S20, Dart.T18, Dart.D12 ]),
            new (97, [ Dart.T19, Dart.D20 ]),
            new (97, [ Dart.S19, Dart.T18, Dart.D12 ]),
            new (96, [ Dart.T20, Dart.D18 ]),
            new (96, [ Dart.S20, Dart.T20, Dart.D8 ]),
            new (95, [ Dart.T19, Dart.D19 ]),
            new (95, [ Dart.OuterBull, Dart.S20, Dart.Bull ]),
            new (95, [ Dart.Bull, Dart.S5, Dart.D20 ]),
            new (94, [ Dart.T18, Dart.D20 ]),
            new (94, [ Dart.S18, Dart.D18, Dart.D20 ]),
            new (93, [ Dart.T19, Dart.D18 ]),
            new (93, [ Dart.S19, Dart.T14, Dart.D16 ]),
            new (92, [ Dart.T20, Dart.D16 ]),
            new (92, [ Dart.S20, Dart.D18, Dart.D18 ]),
            new (91, [ Dart.T17, Dart.D20 ]),
            new (91, [ Dart.S17, Dart.T14, Dart.D16 ]),
            new (90, [ Dart.T20, Dart.D15 ]),
            new (90, [ Dart.T18, Dart.D18 ]),
            new (90, [ Dart.S20, Dart.S20, Dart.Bull ]),
            new (89, [ Dart.T19, Dart.D16 ]),
            new (89, [ Dart.S19, Dart.T20, Dart.D5 ]),
            new (88, [ Dart.T20, Dart.D14 ]),
            new (88, [ Dart.T16, Dart.D20 ]),
            new (88, [ Dart.S20, Dart.T18, Dart.D7 ]),
            new (87, [ Dart.T17, Dart.D18 ]),
            new (87, [ Dart.S17, Dart.T20, Dart.D5 ]),
            new (86, [ Dart.T18, Dart.D16 ]),
            new (86, [ Dart.S18, Dart.T18, Dart.D7 ]),
            new (85, [ Dart.T19, Dart.D14 ]),
            new (85, [ Dart.T15, Dart.D20 ]),
            new (85, [ Dart.S15, Dart.T20, Dart.D5 ]),
            new (84, [ Dart.T20, Dart.D12 ]),
            new (84, [ Dart.T16, Dart.D18 ]),
            new (84, [ Dart.S20, Dart.T14, Dart.D11 ]),
            new (83, [ Dart.T17, Dart.D16 ]),
            new (83, [ Dart.S17, Dart.T16, Dart.D9 ]),
            new (82, [ Dart.T14, Dart.D20 ]),
            new (82, [ Dart.OuterBull, Dart.S17, Dart.D20 ]),
            new (82, [ Dart.Bull, Dart.D16 ]),
            new (81, [ Dart.T19, Dart.D12 ]),
            new (81, [ Dart.T15, Dart.D18 ]),
            new (81, [ Dart.S19, Dart.T12, Dart.D13 ]),
            new (80, [ Dart.T20, Dart.D10 ]),
            new (80, [ Dart.T16, Dart.D16 ]),
            new (80, [ Dart.S20, Dart.S20, Dart.D20 ]),
            new (79, [ Dart.T19, Dart.D11 ]),
            new (79, [ Dart.T13, Dart.D20 ]),
            new (79, [ Dart.S19, Dart.S20, Dart.D20 ]),
            new (78, [ Dart.T18, Dart.D12 ]),
            new (78, [ Dart.S18, Dart.S20, Dart.D20 ]),
            new (77, [ Dart.T19, Dart.D10 ]),
            new (77, [ Dart.S19, Dart.S18, Dart.D20 ]),
            new (76, [ Dart.T20, Dart.D8 ]),
            new (76, [ Dart.S20, Dart.S16, Dart.D20 ]),
            new (75, [ Dart.T17, Dart.D12 ]),
            new (75, [ Dart.S17, Dart.S18, Dart.D20 ]),
            new (75, [ Dart.OuterBull, Dart.Bull ]),
            new (74, [ Dart.T18, Dart.D10 ]),
            new (74, [ Dart.T14, Dart.D16 ]),
            new (74, [ Dart.S15, Dart.S20, Dart.D20 ]),
            new (73, [ Dart.T19, Dart.D8 ]),
            new (73, [ Dart.T11, Dart.D20 ]),
            new (73, [ Dart.S19, Dart.S14, Dart.D20 ]),
            new (72, [ Dart.T16, Dart.D12 ]),
            new (72, [ Dart.T12, Dart.D18 ]),
            new (72, [ Dart.S16, Dart.S16, Dart.D20 ]),
            new (71, [ Dart.T17, Dart.D10 ]),
            new (71, [ Dart.T13, Dart.D16 ]),
            new (71, [ Dart.S13, Dart.S18, Dart.D20 ]),
            new (70, [ Dart.T18, Dart.D8 ]),
            new (70, [ Dart.T10, Dart.D20 ]),
            new (70, [ Dart.S10, Dart.S20, Dart.D20 ]),
            new (69, [ Dart.T19, Dart.D6 ]),
            new (69, [ Dart.T15, Dart.D12 ]),
            new (69, [ Dart.S19, Dart.S10, Dart.D20 ]),
            new (68, [ Dart.T20, Dart.D4 ]),
            new (68, [ Dart.S20, Dart.S16, Dart.D16 ]),
            new (67, [ Dart.T17, Dart.D8 ]),
            new (67, [ Dart.S17, Dart.S10, Dart.D20 ]),
            new (66, [ Dart.T10, Dart.D18 ]),
            new (66, [ Dart.S10, Dart.S16, Dart.D20 ]),
            new (65, [ Dart.OuterBull, Dart.D20 ]),
            new (64, [ Dart.T8, Dart.D20 ]),
            new (64, [ Dart.T16, Dart.D8 ]),
            new (64, [ Dart.S16, Dart.S16, Dart.D16 ]),
            new (63, [ Dart.T9, Dart.D18 ]),
            new (63, [ Dart.T13, Dart.D12 ]),
            new (62, [ Dart.T10, Dart.D16 ]),
            new (62, [ Dart.S10, Dart.S12, Dart.D20 ]),
            new (61, [ Dart.T7, Dart.D20 ]),
            new (61, [ Dart.OuterBull, Dart.D18 ]),
            new (60, [ Dart.S20, Dart.D20 ]),
            new (59, [ Dart.S19, Dart.D20 ]),
            new (58, [ Dart.S18, Dart.D20 ]),
            new (57, [ Dart.S17, Dart.D20 ]),
            new (56, [ Dart.S16, Dart.D20 ]),
            new (55, [ Dart.S15, Dart.D20 ]),
            new (54, [ Dart.S14, Dart.D20 ]),
            new (53, [ Dart.S13, Dart.D20 ]),
            new (52, [ Dart.S20, Dart.D16 ]),
            new (52, [ Dart.S12, Dart.D20 ]),
            new (51, [ Dart.S19, Dart.D16 ]),
            new (51, [ Dart.S11, Dart.D20 ]),
            new (50, [ Dart.S18, Dart.D16 ]),
            new (50, [ Dart.S10, Dart.D20 ]),
            new (49, [ Dart.S9, Dart.D20 ]),
            new (49, [ Dart.S17, Dart.D16 ]),
            new (48, [ Dart.S8, Dart.D20 ]),
            new (48, [ Dart.S16, Dart.D16 ]),
            new (47, [ Dart.S7, Dart.D20 ]),
            new (47, [ Dart.S15, Dart.D16 ]),
            new (46, [ Dart.S6, Dart.D20 ]),
            new (46, [ Dart.S14, Dart.D16 ]),
            new (45, [ Dart.S5, Dart.D20 ]),
            new (45, [ Dart.S13, Dart.D16 ]),
            new (44, [ Dart.S4, Dart.D20 ]),
            new (44, [ Dart.S12, Dart.D16 ]),
            new (43, [ Dart.S3, Dart.D20 ]),
            new (43, [ Dart.S11, Dart.D16 ]),
            new (42, [ Dart.S2, Dart.D20 ]),
            new (42, [ Dart.S10, Dart.D16 ]),
            new (41, [ Dart.S9, Dart.D16 ]),
            new (41, [ Dart.S1, Dart.D20 ]),
            new (40, [ Dart.D20 ]),
            new (40, [ Dart.S8, Dart.D16 ]),
            new (39, [ Dart.S7, Dart.D16 ]),
            new (39, [ Dart.S3, Dart.D18 ]),
            new (38, [ Dart.D19 ]),
            new (38, [ Dart.S6, Dart.D16 ]),
            new (37, [ Dart.S5, Dart.D16 ]),
            new (37, [ Dart.S1, Dart.D18 ]),
            new (36, [ Dart.D18 ]),
            new (36, [ Dart.S4, Dart.D16 ]),
            new (35, [ Dart.S3, Dart.D16 ]),
            new (35, [ Dart.S11, Dart.D12 ]),
            new (34, [ Dart.D17 ]),
            new (34, [ Dart.S2, Dart.D16 ]),
            new (33, [ Dart.S1, Dart.D16 ]),
            new (33, [ Dart.S9, Dart.D12 ]),
            new (32, [ Dart.D16 ]),
            new (32, [ Dart.S8, Dart.D12 ]),
            new (31, [ Dart.S7, Dart.D12 ]),
            new (31, [ Dart.S15, Dart.D8 ]),
            new (30, [ Dart.D15 ]),
            new (30, [ Dart.S6, Dart.D12 ]),
            new (29, [ Dart.S5, Dart.D12 ]),
            new (29, [ Dart.S13, Dart.D8 ]),
            new (28, [ Dart.D14 ]),
            new (28, [ Dart.S4, Dart.D12 ]),
            new (27, [ Dart.S3, Dart.D12 ]),
            new (27, [ Dart.S11, Dart.D8 ]),
            new (26, [ Dart.D13 ]),
            new (26, [ Dart.S10, Dart.D8 ]),
            new (25, [ Dart.S9, Dart.D8 ]),
            new (25, [ Dart.S17, Dart.D4 ]),
            new (24, [ Dart.D12 ]),
            new (24, [ Dart.S8, Dart.D8 ]),
            new (23, [ Dart.S7, Dart.D8 ]),
            new (23, [ Dart.S15, Dart.D4 ]),
            new (22, [ Dart.D11 ]),
            new (22, [ Dart.S6, Dart.D8 ]),
            new (21, [ Dart.S5, Dart.D8 ]),
            new (21, [ Dart.S13, Dart.D4 ]),
            new (20, [ Dart.D10 ]),
            new (20, [ Dart.S4, Dart.D8 ]),
            new (19, [ Dart.S3, Dart.D8 ]),
            new (19, [ Dart.S11, Dart.D4 ]),
            new (18, [ Dart.D9 ]),
            new (18, [ Dart.S2, Dart.D8 ]),
            new (17, [ Dart.S1, Dart.D8 ]),
            new (17, [ Dart.S9, Dart.D4 ]),
            new (16, [ Dart.D8 ]),
            new (16, [ Dart.S8, Dart.D4 ]),
            new (15, [ Dart.S7, Dart.D4 ]),
            new (15, [ Dart.S3, Dart.D6 ]),
            new (14, [ Dart.D7 ]),
            new (14, [ Dart.S6, Dart.D4 ]),
            new (13, [ Dart.S5, Dart.D4 ]),
            new (13, [ Dart.S1, Dart.D6 ]),
            new (12, [ Dart.D6 ]),
            new (12, [ Dart.S4, Dart.D4 ]),
            new (11, [ Dart.S3, Dart.D4 ]),
            new (11, [ Dart.S7, Dart.D2 ]),
            new (10, [ Dart.D5 ]),
            new (10, [ Dart.S2, Dart.D4 ]),
            new (9, [ Dart.S1, Dart.D4 ]),
            new (9, [ Dart.S5, Dart.D2 ]),
            new (8, [ Dart.D4 ]),
            new (8, [ Dart.S4, Dart.D2 ]),
            new (7, [ Dart.S3, Dart.D2 ]),
            new (7, [ Dart.S1, Dart.D3 ]),
            new (6, [ Dart.D3 ]),
            new (6, [ Dart.S2, Dart.D2 ]),
            new (5, [ Dart.S1, Dart.D2 ]),
            new (5, [ Dart.S3, Dart.D1 ]),
            new (4, [ Dart.D2 ]),
            new (4, [ Dart.S2, Dart.D1 ]),
            new (3, [ Dart.S1, Dart.D1 ]),
            new (2, [ Dart.D1 ]),
        }.ToLookup(x => x.Score, x => x);
    }

}
